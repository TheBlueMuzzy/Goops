# Milestone v1.0: MVP

**Status:** SHIPPED 2026-01-21
**Phases:** 1-7
**Total Plans:** 22

## Overview

Build the complication system, balance it for fair progression, add visual feedback via HUD meters, and implement the upgrade system that lets players tune difficulty over time.

## Phases

### Phase 1: Dial Rotation

**Goal**: Make the Reset Controls dial spin when dragged
**Depends on**: Nothing (first phase)
**Plans**: 1 plan

Plans:
- [x] 01-01: Implement dial drag rotation with snap-to-corner

**Details:**
- Dial responds to drag input anywhere on dial surface
- Snaps to 4 corners (45, 135, 225, 315) on release
- SVG coordinate conversion using getScreenCTM().inverse()
- Works on both PC (mouse) and mobile (touch)

### Phase 2: Minigame Logic

**Goal**: Implement puzzle rules for all three minigames
**Depends on**: Phase 1
**Plans**: 3 plans

Plans:
- [x] 02-01: Reset Laser puzzle (4 sliders match indicator lights)
- [x] 02-02: Reset Lights puzzle (sequence memory: slider + 4-button sequence)
- [x] 02-03: Reset Controls puzzle (dial alignment: 4 corners in sequence)

**Details:**
- Reset Laser: 4 sliders, match indicator lights, center targets harder
- Reset Lights: Slider + watch 4-button sequence + repeat + slider
- Reset Controls: Align dial to 4 random corners, tap to confirm each

### Phase 3: Complications

**Goal**: Define complications and how they trigger during gameplay
**Depends on**: Phase 2
**Plans**: 3 plans

Plans:
- [x] 03-01: Complication types and trigger definitions
- [x] 03-02: Gameplay effects implementation
- [x] 03-03: UI and console updates (alerts, panel indicators)

**Details:**
- LASER: Capacitor drains, triggers two-tap mechanic
- LIGHTS: Probability-based trigger, dims screen to 10%
- CONTROLS: Heat meter trigger, requires double input
- Pulsing red malfunction alerts in periscope view
- Console panel lights only active when complication exists

### Phase 4: Minigame-Complication Integration

**Goal**: Connect minigame solutions to complications
**Depends on**: Phase 3
**Plans**: 4 plans

Plans:
- [x] 04-01: Final cleanup and bug fixes
- [x] 04-02: LIGHTS complication rewrite (pressure gap trigger)
- [x] 04-03: CONTROLS complication rewrite (heat meter trigger)
- [x] 04-04: Documentation updates

**Details:**
- LIGHTS: 50% chance on piece lock when pressure 3-5 rows above highest goop
- CONTROLS: Heat meter reaches 100 (builds +5 per rotation, drains at 50/sec)
- CSS filter for LIGHTS effect (keeps alert visible)
- Double-input + half speed for CONTROLS effect

### Phase 5: HUD & Balance

**Goal**: Add visual meters for LASER/CONTROLS, rewrite trigger mechanics, tune values
**Depends on**: Phase 4
**Plans**: 4 plans

Plans:
- [x] 05-01: Meter state and UI (HudMeter component)
- [x] 05-02: LASER meter logic (capacitor drain)
- [x] 05-03: CONTROLS heat logic (heat buildup/dissipation)
- [x] 05-04: Cooldowns and rank unlocks

**Details:**
- Laser capacitor: Drains 4 per unit popped, LASER triggers at 0
- Controls heat: +5 per rotation, drains 50/sec idle, CONTROLS at 100
- Cooldown formula: max(8, 20 - (rank - unlockRank)) seconds
- Rank unlocks: LASER@1, LIGHTS@2, CONTROLS@3
- Meters only visible at appropriate rank

### Phase 6: Progression System

**Goal**: Tune XP/rank curve, implement XP floor, prepare for milestone unlocks
**Depends on**: Phase 5
**Plans**: 2 plans

Plans:
- [x] 06-01: XP floor and curve retuning
- [x] 06-02: Milestone infrastructure

**Details:**
- XP curve: `(rank+2) * (1750 + 250*rank)`
- Rank 1: 6,000 XP | Rank 10: 51,000 XP | Rank 100: 2,728,500 XP
- XP floor: `max(100 * rank, score)` prevents zero-gain runs
- Milestones at ranks 10, 20, 30... 100
- MILESTONE_REACHED event for future UI celebrations

### Phase 7: System Upgrades

**Goal**: Build upgrade UI and implement upgrade effects
**Depends on**: Phase 6
**Plans**: 4 plans

Plans:
- [x] 07-01: System upgrade definitions
- [x] 07-02: Upgrade effects implementation
- [x] 07-03: Upgrade UI panel (+ FIX for UAT issues)
- [x] 07-04: Max-level minigame effects

**Details:**
- LASER upgrade: -5% drain per level, max removes center targets
- LIGHTS upgrade: -6% trigger chance per level, max uses 3-button sequence
- CONTROLS upgrade: +10% dissipation per level, max uses 3 alignments
- Upgrade panel matches EndGameScreen styling
- Upgrades unlocked progressively by rank

---

## Milestone Summary

**Key Decisions:**

- SVG coordinate conversion requires hidden reference element (preserveAspectRatio issue)
- Reset Lights: Sequence memory over Lights Out toggle (toggle had null space)
- LIGHTS effect via CSS filter on SVG (keeps alert visible)
- CONTROLS tracks heat meter not input counter (continuous feedback)
- All rank checks use starting rank, not mid-run rank
- System-specific upgrades only (direct mitigation of difficulty)

**Issues Resolved:**

- Stale closure bug in dial rotation (fixed with refs)
- CSS shake animation overriding rotation (fixed with nested groups)
- Array mutation bug in complications (fixed with spread operator)
- Multiple UAT issues in upgrade panel (rank filtering, styling, dimensions)

**Issues Deferred:**

- Edge-only drag zone for dial (optional enhancement)
- Starting junk mechanic (Band 1 feature)
- Multi-color pieces (Band 2 feature)

**Technical Debt Incurred:**

- None significant

---

_For current project status, see .planning/ROADMAP.md_
