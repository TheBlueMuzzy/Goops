---
phase: 09-art-decomposition
plan: 03
type: execute
---

<objective>
Integrate extracted hooks and components into Art.tsx, removing duplicated code.

Purpose: Replace the original inline code with the extracted hooks and components, achieving the target file size reduction.
Output: Refactored Art.tsx under 400 lines using the extracted modules.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-art-decomposition/09-01-SUMMARY.md
@.planning/phases/09-art-decomposition/09-02-SUMMARY.md

**Key files:**
@components/Art.tsx (target for refactoring)
@types/minigames.ts
@hooks/useLaserMinigame.ts
@hooks/useLightsMinigame.ts
@hooks/useControlsMinigame.ts
@components/MiniGames/LaserPanel.tsx
@components/MiniGames/LightsPanel.tsx
@components/MiniGames/ControlsPanel.tsx
@components/MiniGames/ArcadeButton.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Integrate minigame hooks into Art.tsx</name>
  <files>components/Art.tsx</files>
  <action>
Replace inline minigame state with hook calls:

1. Add imports at top:
   - Import useLaserMinigame, useLightsMinigame, useControlsMinigame
   - Import types from types/minigames.ts

2. In ConsoleLayoutSVG component:
   - Remove state declarations (lines 179-243)
   - Remove minigame initialization useEffect (lines 246-311)
   - Remove all minigame helper functions (updateLaserSlider, generateLightsSequence, startShowingSequence, handleLightsButton, handleLightsSliderChange, getLaserLightColors, getLightsButtonLightColor, getLightsSliderLightColors, getLaserTextState, getLightsTextState, getControlsTextState, getControlsCornerLightColor, isDialAligned, triggerDialShake, handleDialPress)
   - Remove dial drag handlers (handleDialStart, handleDialMove, handleDialEnd, screenToSvg)
   - Remove dial coordinate constants (DIAL_CENTER_X/Y, etc.)
   - Remove dial event listener useEffect (lines 477-506)

3. Add hook calls:
```tsx
const {
  laserSliders, updateLaserSlider, shakingSlider,
  getLaserLightColors, getLaserTextState
} = useLaserMinigame({
  complications,
  isLaserMaxed,
  onResolveComplication
});

const {
  lightsComplication, lightSlider,
  handleLightsButton, handleLightsSliderChange,
  lightsSliderShaking,
  getLightsButtonLightColor, getLightsSliderLightColors, getLightsTextState
} = useLightsMinigame({
  complications,
  isLightsMaxed,
  pressedBtn,
  onResolveComplication
});

const {
  localDialRotation, isDialDragging, dialShaking, dialPressed,
  handleDialStart, handleDialMove, handleDialEnd, handleDialPress,
  getControlsCornerLightColor, getControlsTextState, CORNER_ANGLES
} = useControlsMinigame({
  complications,
  isControlsMaxed,
  onResolveComplication
});
```

Keep the pressedBtn state and handlePress/handleRelease for now (used by LightsPanel).
  </action>
  <verify>npm run test:run passes, TypeScript compiles</verify>
  <done>Art.tsx uses hooks for all minigame state, removed ~400 lines of inline code</done>
</task>

<task type="auto">
  <name>Task 2: Integrate minigame panel components</name>
  <files>components/Art.tsx</files>
  <action>
Replace inline SVG sections with component calls:

1. Remove ArcadeButton component definition (lines 50-101) - now in MiniGames/ArcadeButton.tsx

2. Replace Reset Laser SVG section (lines 994-1092) with:
```tsx
<LaserPanel
  laserSliders={laserSliders}
  shakingSlider={shakingSlider}
  onSliderChange={updateLaserSlider}
  getLaserLightColors={getLaserLightColors}
  textState={getLaserTextState()}
/>
```

3. Replace Reset Lights SVG section (lines 1094-1240) with:
```tsx
<LightsPanel
  lightsComplication={lightsComplication}
  lightSlider={lightSlider}
  onSliderChange={handleLightsSliderChange}
  onButtonPress={handlePress}
  onButtonRelease={handleRelease}
  getLightsButtonLightColor={getLightsButtonLightColor}
  getLightsSliderLightColors={getLightsSliderLightColors}
  textState={getLightsTextState()}
  pressedBtn={pressedBtn}
/>
```

4. Replace Reset Controls SVG section with:
```tsx
<ControlsPanel
  localDialRotation={localDialRotation}
  isDialDragging={isDialDragging}
  dialShaking={dialShaking}
  dialPressed={dialPressed}
  onDialStart={handleDialStart}
  onDialMove={handleDialMove}
  onDialEnd={handleDialEnd}
  onDialPress={handleDialPress}
  getControlsCornerLightColor={getControlsCornerLightColor}
  textState={getControlsTextState()}
/>
```

5. Add component imports at top

Keep the SVG defs, gradients, and clip paths in Art.tsx since they're referenced by multiple sections.
  </action>
  <verify>npm run test:run passes, TypeScript compiles</verify>
  <done>Art.tsx uses panel components for all minigame rendering, further reduced</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Decomposed Art.tsx from 1,478 lines into focused modules</what-built>
  <how-to-verify>
    1. Run: npm run dev -- --host
    2. Visit localhost on phone/desktop
    3. Test LASER minigame: Trigger complication, move all 4 sliders to match lit indicators, verify solve
    4. Test LIGHTS minigame: Trigger complication, move slider to lit position, watch sequence, repeat sequence, move slider again, verify solve
    5. Test CONTROLS minigame: Trigger complication, drag dial to lit corner, tap dial, repeat 4 times, verify solve
    6. Verify "FIXED" text appears briefly when each minigame solves
    7. Verify wrong slider/dial positions trigger shake animation
    8. Confirm no visual changes from before refactor
  </how-to-verify>
  <resume-signal>Type "approved" or describe any issues with minigame functionality</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run test:run` passes all 81 tests
- [ ] TypeScript compiles without errors
- [ ] Art.tsx is under 400 lines
- [ ] All three minigames work correctly
- [ ] Visual appearance unchanged
- [ ] Human verification passed
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Art.tsx reduced from 1,478 to under 400 lines
- No gameplay or visual regressions
</success_criteria>

<output>
After completion, create `.planning/phases/09-art-decomposition/09-03-SUMMARY.md`:

# Summary 09-03: Art.tsx Integration

## Status: COMPLETE

## What Was Done
- Integrated minigame hooks into Art.tsx
- Replaced inline SVG with panel components
- Achieved target file size reduction

## Files Changed
| File | Change |
|------|--------|
| components/Art.tsx | Reduced from 1,478 to ~XXX lines |

## Line Count Summary
- Before: 1,478 lines (Art.tsx)
- After: ~XXX lines (Art.tsx) + hooks + components
- New files created: 7 (types, 3 hooks, 4 components)

## Test Results
- All 81 tests passing
- No regressions

## Phase 9 Complete
Art.tsx successfully decomposed. Ready for Phase 10 (GameBoard.tsx Decomposition).
</output>
