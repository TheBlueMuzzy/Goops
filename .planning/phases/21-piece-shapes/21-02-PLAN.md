---
phase: 21-piece-shapes
plan: 02
type: execute
---

<objective>
Define all 54 piece shapes by parsing coordinates from the SVG and creating piece definition arrays.

Purpose: Provide the actual piece shape data that the spawn system will use.
Output: TETRA_PIECES, PENTA_PIECES, HEXA_PIECES arrays with all 54 piece definitions.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/21-piece-shapes/21-RESEARCH.md
@.planning/phases/21-piece-shapes/21-01-SUMMARY.md

**Source file for coordinates:**
@art/Minos.svg

**Key implementation files:**
@src/constants.ts
@src/types.ts

**SVG Structure (from Minos.svg):**
- Tetra group: 5 normal (cls-5 dark green) + 5 corrupted (cls-3 light green)
- Penta group: 11 normal (cls-2 dark red) + 11 corrupted (cls-4 light red)
- Hexa group: 11 normal (cls-1 dark blue) + 11 corrupted (cls-6 light blue)
- Each piece is a `<g>` containing `<rect>` elements
- Grid cell size: 36px
- Coordinates need to be converted from SVG absolute to relative piece coordinates

**Existing pattern (from constants.ts):**
```typescript
const makePiece = (type: PieceType, coords: number[][]): PieceDefinition => ({
  type,
  color: COLORS.RED, // Color assigned at spawn time
  cells: coords.map(([x, y]) => ({ x, y }))
});
```
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define Tetra pieces (10 total)</name>
  <files>src/constants.ts</files>
  <action>
Parse the Tetra group from Minos.svg and create piece definitions.

**SVG parsing approach:**
1. Each `<rect>` has x/y in absolute SVG coordinates
2. Cell size is 36px, so divide by 36 to get grid coordinates
3. Normalize coordinates relative to piece center (subtract min to get 0-based, then center)

**Expected pieces from SVG analysis:**

**TETRA_NORMAL (5 pieces):**
```typescript
// T_I: Vertical bar (4 cells in column)
// SVG rects at: (16.29, 0), (16.29, 36), (16.29, 72), (16.29, 108)
// Normalized: [{x:0,y:0}, {x:0,y:1}, {x:0,y:2}, {x:0,y:3}]
const PIECE_T_I = makePiece(PieceType.T_I, [[0,-1], [0,0], [0,1], [0,2]]);

// T_L: L-shape
// SVG rects at: (152.68, 36), (152.68, 72), (152.68, 108), (188.67, 36)
// Normalized relative to center
const PIECE_T_L = makePiece(PieceType.T_L, [[0,-1], [0,0], [0,1], [1,-1]]);

// T_T: T with diagonal (the "broken T" already in game)
// SVG rects at: (282.78, 36), (282.78, 72), (282.78, 108), (318.78, 72)
const PIECE_T_T = makePiece(PieceType.T_T, [[0,-1], [0,0], [0,1], [1,0]]);

// T_S: S-shape
// SVG rects at: (430.9, 36), (430.9, 72), (466.9, 72), (466.9, 108)
const PIECE_T_S = makePiece(PieceType.T_S, [[0,-1], [0,0], [1,0], [1,1]]);

// T_O: 2x2 square
// SVG rects at: (603.04, 72), (603.04, 108), (639.03, 72), (639.03, 108)
const PIECE_T_O = makePiece(PieceType.T_O, [[0,0], [0,1], [1,0], [1,1]]);
```

**TETRA_CORRUPTED (5 pieces):**
Parse the second row of Tetra group (cls-3 green pieces).
These have non-contiguous cells (corner-touching only).

```typescript
// T_I_C: Split Z pattern (2+2 cells separated diagonally)
// SVG rects at: (3.64, 252.57), (3.64, 288.57), (39.64, 180.57), (39.64, 216.57)
const PIECE_T_I_C = makePiece(PieceType.T_I_C, [[0,2], [0,3], [1,0], [1,1]]);

// T_L_C: L with gap
const PIECE_T_L_C = makePiece(PieceType.T_L_C, [[0,0], [0,1], [1,0], [1,2]]);

// T_T_C: Spread T
const PIECE_T_T_C = makePiece(PieceType.T_T_C, [[0,0], [0,2], [1,1], [2,1]]);

// T_S_C: Corrupted S
const PIECE_T_S_C = makePiece(PieceType.T_S_C, [[0,2], [1,0], [1,1], [2,1]]);

// T_O_C: Diagonal corners
const PIECE_T_O_C = makePiece(PieceType.T_O_C, [[0,0], [0,2], [1,1], [1,2]]);
```

Export as:
```typescript
export const TETRA_NORMAL = [PIECE_T_I, PIECE_T_L, PIECE_T_T, PIECE_T_S, PIECE_T_O];
export const TETRA_CORRUPTED = [PIECE_T_I_C, PIECE_T_L_C, PIECE_T_T_C, PIECE_T_S_C, PIECE_T_O_C];
export const TETRA_PIECES = [...TETRA_NORMAL, ...TETRA_CORRUPTED];
```

**Important:** Verify each piece has exactly 4 cells. Mark which pieces are asymmetric (need mirror support).
  </action>
  <verify>TETRA_PIECES array has 10 elements. Each element has exactly 4 cells. TypeScript compiles.</verify>
  <done>10 Tetra pieces defined (5 normal + 5 corrupted)</done>
</task>

<task type="auto">
  <name>Task 2: Define Penta pieces (22 total)</name>
  <files>src/constants.ts</files>
  <action>
Parse the Penta group from Minos.svg and create piece definitions.

**PENTA_NORMAL (11 pieces):**
From SVG Penta group (cls-2 dark red rects):

```typescript
// P_I: 5-cell vertical bar
const PIECE_P_I = makePiece(PieceType.P_I, [[0,-2], [0,-1], [0,0], [0,1], [0,2]]);

// P_L: L with tail (cross-like)
// SVG analysis shows 5 rects forming an L variant
const PIECE_P_L = makePiece(PieceType.P_L, [[0,0], [0,1], [1,1], [1,2], [2,1]]);

// P_X: Plus/cross shape (symmetric)
const PIECE_P_X = makePiece(PieceType.P_X, [[0,1], [1,0], [1,1], [1,2], [2,1]]);

// P_U: U-shape
const PIECE_P_U = makePiece(PieceType.P_U, [[0,0], [0,1], [1,0], [1,1], [1,2]]);

// P_L2: Alternate L (longer)
const PIECE_P_L2 = makePiece(PieceType.P_L2, [[0,0], [0,1], [0,2], [1,2], [1,3]]);

// P_Y: Y-shape (vertical with bump)
const PIECE_P_Y = makePiece(PieceType.P_Y, [[0,0], [0,1], [0,2], [0,3], [1,3]]);

// P_T: T5 shape (big T)
const PIECE_P_T = makePiece(PieceType.P_T, [[0,0], [1,0], [1,1], [1,2], [2,0]]);

// P_S: S5 shape (corner stairs)
const PIECE_P_S = makePiece(PieceType.P_S, [[0,0], [0,1], [0,2], [1,2], [2,2]]);

// P_P: P-shape
const PIECE_P_P = makePiece(PieceType.P_P, [[0,0], [0,1], [0,2], [0,3], [1,2]]);

// P_Z: Z5 shape
const PIECE_P_Z = makePiece(PieceType.P_Z, [[0,0], [1,0], [1,1], [1,2], [2,2]]);

// P_W: W-shape (stairs)
const PIECE_P_W = makePiece(PieceType.P_W, [[0,0], [1,0], [1,1], [2,1], [2,2]]);
```

**PENTA_CORRUPTED (11 pieces):**
From SVG Penta group (cls-4 light red rects):
Define matching corrupted variants with non-contiguous cells.

Export as:
```typescript
export const PENTA_NORMAL = [PIECE_P_I, PIECE_P_L, PIECE_P_X, ...];
export const PENTA_CORRUPTED = [PIECE_P_I_C, PIECE_P_L_C, PIECE_P_X_C, ...];
export const PENTA_PIECES = [...PENTA_NORMAL, ...PENTA_CORRUPTED];
```

**Important:** Verify each piece has exactly 5 cells.
  </action>
  <verify>PENTA_PIECES array has 22 elements. Each element has exactly 5 cells. TypeScript compiles.</verify>
  <done>22 Penta pieces defined (11 normal + 11 corrupted)</done>
</task>

<task type="auto">
  <name>Task 3: Define Hexa pieces (22 total)</name>
  <files>src/constants.ts</files>
  <action>
Parse the Hexa group from Minos.svg and create piece definitions.

**HEXA_NORMAL (11 pieces):**
From SVG Hexa group (cls-1 dark blue rects):

```typescript
// H_I: 6-cell vertical bar
const PIECE_H_I = makePiece(PieceType.H_I, [[0,-2], [0,-1], [0,0], [0,1], [0,2], [0,3]]);

// Parse remaining 10 hexa shapes from SVG...
// Each shape has 6 cells
```

**HEXA_CORRUPTED (11 pieces):**
From SVG Hexa group (cls-6 light blue rects):
Define matching corrupted variants with non-contiguous cells.

Export as:
```typescript
export const HEXA_NORMAL = [PIECE_H_I, PIECE_H_L, PIECE_H_X, ...];
export const HEXA_CORRUPTED = [PIECE_H_I_C, PIECE_H_L_C, PIECE_H_X_C, ...];
export const HEXA_PIECES = [...HEXA_NORMAL, ...HEXA_CORRUPTED];
```

Also add a combined export for convenience:
```typescript
export const ALL_NEW_PIECES = [...TETRA_PIECES, ...PENTA_PIECES, ...HEXA_PIECES];
```

**Important:** Verify each piece has exactly 6 cells.
  </action>
  <verify>HEXA_PIECES array has 22 elements. Each element has exactly 6 cells. TypeScript compiles.</verify>
  <done>22 Hexa pieces defined (11 normal + 11 corrupted)</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run test:run` passes
- [ ] `npm run build` succeeds
- [ ] TETRA_PIECES has 10 pieces (5 normal + 5 corrupted), each with 4 cells
- [ ] PENTA_PIECES has 22 pieces (11 normal + 11 corrupted), each with 5 cells
- [ ] HEXA_PIECES has 22 pieces (11 normal + 11 corrupted), each with 6 cells
- [ ] Total: 54 new pieces defined
- [ ] All exports accessible from constants.ts
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- 54 piece definitions match SVG source
- Ready for Plan 03 (spawn logic)
</success_criteria>

<output>
After completion, create `.planning/phases/21-piece-shapes/21-02-SUMMARY.md`
</output>
