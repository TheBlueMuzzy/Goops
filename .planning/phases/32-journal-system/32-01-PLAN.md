---
phase: 32-journal-system
plan: 01
type: execute
---

<objective>
Create the journal data layer and OperatorJournal UI component that replaces the static HowToPlay screen.

Purpose: Transform the ? button from a static manual into a living reference that grows with player progression — pages unlock as tutorial steps complete.
Output: JournalEntry data definitions, OperatorJournal component with page navigation and unlock logic, visual styling matching the maintenance-order aesthetic.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/31-tutorial-infrastructure/31-01-SUMMARY.md
@.planning/phases/31-tutorial-infrastructure/31-02-SUMMARY.md
@.planning/phases/31-tutorial-infrastructure/31-03-SUMMARY.md

@types/tutorial.ts
@data/tutorialSteps.ts
@hooks/useTutorial.ts
@components/HowToPlay.tsx
@types.ts

**Tech stack available:** React, TypeScript, Tailwind, lucide-react icons
**Established patterns:** TutorialStepId union type, SaveData.tutorialProgress.completedSteps, IntercomMessage format, maintenance-order visual style (31-02)
**Constraining decisions:**
- Phase 31: tutorialProgress stores completedSteps as string[] of TutorialStepId values
- Phase 31: "maintenance order" visual style for tutorial UI (grungy, low-tech industrial)
- Journal grows additively — entries unlock but never disappear
- Rank IS the tutorial gate (no separate journal progression)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create journal entry data and types</name>
  <files>data/journalEntries.ts, types/tutorial.ts</files>
  <action>
Define journal entry data that maps tutorial concepts to journal pages.

In `types/tutorial.ts`, add:
- `JournalPageId` type — string union covering each journal topic: 'BASICS', 'CONTROLS', 'POPPING', 'SCORING', 'CRACKS', 'WRAPPING', 'COMPLICATIONS_LIGHTS', 'COMPLICATIONS_LASER', 'COMPLICATIONS_CONTROLS', 'UPGRADES', 'ABILITIES'. These are broader than TutorialStepId — one journal page may cover multiple tutorial steps.
- `JournalPage` interface — `{ id: JournalPageId; title: string; icon: string; unlockedBy: TutorialStepId | 'ALWAYS'; sections: JournalSection[] }`
- `JournalSection` interface — `{ heading: string; body: string }` (plain text, rendered by component)

In `data/journalEntries.ts`, create `JOURNAL_PAGES: JournalPage[]` array:
- 'BASICS' page (unlockedBy: 'ALWAYS') — always visible. Title: "THE OBJECTIVE". Sections: pressure overview, popping basics. Content mirrors HowToPlay Section 1 but shorter, punchier (8 words max per line where possible).
- 'CONTROLS' page (unlockedBy: 'ROTATE_INTRO') — Title: "CONTROLS". Sections: tank rotation, piece rotation, soft drop, hold/swap, console return, click to pop. Mirrors HowToPlay Section 2 content.
- 'POPPING' page (unlockedBy: 'POP_TIMING') — Title: "PURGING". Sections: what makes goop poppable, timing tension (scaffolding vs pressure).
- 'SCORING' page (unlockedBy: 'FIRST_SHIFT') — Title: "SCORING". Sections: group size bonus, elevation bonus.
- 'CRACKS' page (unlockedBy: 'CRACK_INTRO') — Title: "STRUCTURAL DAMAGE". Sections: cracks spread, sealing cracks with goop.
- 'WRAPPING' page (unlockedBy: 'WRAP_INTRO') — Title: "CYLINDER WRAP". Sections: tank wraps around, goop connects across seam.
- Remaining pages (COMPLICATIONS_LIGHTS, COMPLICATIONS_LASER, COMPLICATIONS_CONTROLS, UPGRADES, ABILITIES) — stub with unlockedBy pointing to matching TutorialStepId, minimal placeholder content (1 section each). These get real content in Phases 35-36.

Keep the icon field as a string name from lucide-react (e.g., 'Gauge', 'Keyboard', 'Zap') — the component will map these to actual icon components.

Do NOT import React or any component libraries in the data file. Keep it pure data.
  </action>
  <verify>TypeScript compiles with no errors: `npx tsc --noEmit`</verify>
  <done>JournalPageId type exists, JournalPage/JournalSection interfaces exist, JOURNAL_PAGES array has 11 entries with content for first 6 pages and stubs for remaining 5</done>
</task>

<task type="auto">
  <name>Task 2: Build OperatorJournal component</name>
  <files>components/OperatorJournal.tsx, components/OperatorJournal.css</files>
  <action>
Create `OperatorJournal` component that replaces the static HowToPlay.

Props: `{ completedSteps: string[]; onBack: () => void }`

**Layout** (matches HowToPlay's full-screen overlay pattern):
- Fixed inset-0 overlay with same aspect-ratio container as HowToPlay (9:16 constrained)
- Left side: vertical page tab list (scrollable if needed). Each tab shows icon + short title.
- Right/main area: selected page content with sections.
- Locked pages show as dimmed/redacted tabs with a lock icon — NOT hidden. Player sees there's more to discover.
- Active (selected) tab gets a bright border/highlight.
- Back button at bottom (same green circle as HowToPlay).

**Unlock logic:**
- Filter JOURNAL_PAGES: page is unlocked if `page.unlockedBy === 'ALWAYS'` OR `completedSteps.includes(page.unlockedBy)`
- Locked pages render in tab list but are not selectable (dimmed, lock icon overlay)
- Default selection: first unlocked page

**Visual style — maintenance-order aesthetic (from 31-02):**
- Background: slate-950 with subtle green radial gradient (reuse HowToPlay pattern)
- Page tabs: bg-slate-900 border-slate-700, industrial feel
- Content area: bg-slate-900/80 with border-slate-800, same card style as HowToPlay sections
- Section headings: uppercase, tracking-wider, slate-200
- Body text: slate-400, text-sm
- Use the same font family as HowToPlay header: `"From Where You Are", cursive`
- Title at top: "OPERATOR JOURNAL" (not "Operator Manual")

**Icon mapping:** Create a simple lookup object inside the component file that maps icon string names to lucide-react components (Gauge, Keyboard, Target, Zap, etc.). Import only the icons actually used. Do NOT create a generic icon resolver — just a plain object with the ~8 icons needed.

**CSS file:** Only add CSS if animations are needed (e.g., fade-in for page content transitions). Keep minimal — prefer Tailwind classes. A simple opacity transition on page content switch is sufficient.

**Mobile considerations:**
- Tab list should be a horizontal scrollable strip at top on narrow screens (< 400px width), vertical sidebar on wider screens. Use a simple responsive approach — a flex-col on wider, flex-row + overflow-x-auto on narrow. Media query or container-based.
- Touch-friendly tab sizes (minimum 44px tap targets)
  </action>
  <verify>TypeScript compiles with no errors: `npx tsc --noEmit`</verify>
  <done>OperatorJournal component renders with tab navigation, shows unlocked pages with content, locked pages appear dimmed, back button works, maintenance-order visual style applied</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>OperatorJournal component with page navigation, unlock logic, and maintenance-order styling. Replaces static HowToPlay content with a dynamic, growing journal.</what-built>
  <how-to-verify>
    1. Run: `npm run dev -- --host`
    2. Note: Component is not yet wired into the app (that's Plan 32-02). For now, temporarily render it to verify:
       - In App.tsx, temporarily replace the `<HowToPlay onBack={...} />` render with `<OperatorJournal completedSteps={saveData.tutorialProgress.completedSteps} onBack={...} />`
       - Click the ? button from main menu
    3. Verify: BASICS page is always visible and selected by default
    4. Verify: CONTROLS page appears locked (dimmed, not selectable) since ROTATE_INTRO hasn't been completed
    5. Verify: Tab list shows all 11 pages (6 with content, 5 stubs) — locked ones are visible but greyed out
    6. Verify: Content area shows section headings and body text in maintenance-order style
    7. Verify: Back button (green circle) returns to previous screen
    8. Verify: Mobile layout — tabs readable and tappable on phone-width viewport
    9. Revert the temporary App.tsx change after verification
  </how-to-verify>
  <resume-signal>Type "approved" to continue to Plan 32-02 (integration), or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes with no errors
- [ ] JOURNAL_PAGES data has 11 entries
- [ ] OperatorJournal renders without React errors
- [ ] Locked/unlocked page logic works correctly
- [ ] Visual style matches maintenance-order aesthetic
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Journal data layer is clean, pure data (no React imports)
- OperatorJournal component handles unlock logic and page navigation
- Visual style matches existing tutorial aesthetic (maintenance-order)
</success_criteria>

<output>
After completion, create `.planning/phases/32-journal-system/32-01-SUMMARY.md`
</output>
